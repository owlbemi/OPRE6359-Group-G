---
title: "GroupG"
output: html_document
---
# Config Git
``git config --global user.name "Your Name"``
``git config --global user.email "your.email@example.com"``

# Required packages

```{r}
# run remotes::install_github("benyamindsmith/RKaggle")
library(RKaggle)
library(dplyr)
library(tidyr)
library(caret)
```

# Importing Data

Reference: https://www.kaggle.com/datasets/sahilislam007/ai-impact-on-job-market-20242030

```{r}
raw_df <- get_dataset("sahilislam007/ai-impact-on-job-market-20242030")
```

# Basic Data Cleaning

```{r}
summary(raw_df)

# factorise certain columns

df <- raw_df

cols <- c("Job Status", "Required Education", "AI Impact Level", "Industry")
df[cols] <- lapply(raw_df[cols], as.factor)

# order the factors

df$`AI Impact Level` <- factor(
  df$`AI Impact Level`,
  levels = c("Low", "Moderate", "High"),
  ordered = TRUE
)

df$`Required Education` <- factor(
  df$`Required Education`,
  levels = c("High School", "Associate Degree", "Bachelor’s Degree", "Master’s Degree", "PhD"),
  ordered = TRUE
)

```


```{r}
head(df)

summary(df)
```
# Train / Test Data
  
```{r}
# set random seed for ML
set.seed(2021)

train_index <- sample(1:nrow(df), 0.6 * nrow(df))

train.df <- df[train_index, ]
test.df <- df[-train_index, ]

# Run Logreg

logit.reg <- glm(`Job Status` ~ `AI Impact Level` + `Median Salary (USD)` + `Required Education` + `Experience Required (Years)` + `Job Openings (2024)` + `Projected Openings (2030)` + `Remote Work Ratio (%)` + `Automation Risk (%)` + `Gender Diversity (%)`, 
                 data = train.df, 
                 family = "binomial")

summary(logit.reg)
```

# Prediction

```{r}
logitPredict <- predict(logit.reg, test.df, type = "response")

summary(logitPredict)

logitPredictClass <- ifelse(logitPredict > 0.5, 1, 0)
```

# Confusion Matrix

```{r}
actual <- test.df$`Job Status`
predict <- logitPredictClass
cm <- table(predict, actual)

cm

```
